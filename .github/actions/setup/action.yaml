name: "Setup Action"
description: "Checkouts the repo, sets up node, and installs dependencies"
runs:
  using: "composite"
  steps:
    - name: Checkout Repository
      uses: actions/checkout@692973e3d937129bcbf40652eb9f2f61becf3332 # v4

    - name: Install pnpm
      uses: pnpm/action-setup@v4
      with:
        version: "10.11.0"
        run_install: false

    - name: Install build tools
      if: runner.os == 'Linux'
      run: |
        sudo apt-get update
        sudo apt-get install -y build-essential python3 python3-pip
      shell: bash

    - name: Install Node.js
      uses: actions/setup-node@v4
      with:
        node-version: 22
        cache: "pnpm"

    - name: Install dependencies
      run: "pnpm install --frozen-lockfile"
      shell: bash

    - name: Rebuild native modules
      run: "pnpm exec electron-rebuild --version 36.4.0 --force"
      shell: bash
